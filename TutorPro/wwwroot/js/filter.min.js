function sendRequest(n=null,t=null,i=1){var r=$("#sort").siblings(".new-select__list").find(".new-select__item.selected").attr("data-value"),u=document.getElementsByClassName("filter-form__input")[0].value,f,e;if(n!==null&&t!==null)switch(n){case"grade":grade=t;break;case"level":level=t;break;case"sort":r=t;break;case"search":u=t}f=document.querySelector(".matirials__pagination");e=f.getAttribute("data-pageSize");const o=document.getElementById("materials_filter"),s=o.getAttribute("data-language"),h=o.getAttribute("data-pageId");$.ajax({url:"/Umbraco/Api/Materials/GetMaterials",method:"POST",contentType:"application/json; charset=utf-8",headers:{Accept:"application/json"},data:JSON.stringify({subject:subjects,language:s,categoryItems:getCategories(),sort:r,page:i,pageSize:e,pageId:h,searchText:u}),success:function(n){updateContent(n)},error:function(n,t,i){console.error(i)}})}function getSelectedItemsByCategory(n){const t=`.selected[data-categorie="${n}"]`;return document.querySelectorAll(t)}function getSelectedKeysByCategory(n){const t=getSelectedItemsByCategory(n);return Array.from(t).map(n=>n.getAttribute("data-key"))}function updateContent(n){var t,i,r;$(".matirials__block").empty();t=$(".matirials__block").attr("data-reviews");i=$(".matirials__block").attr("data-culture");n.materials&&n.materials.length>0?n.materials.forEach(function(n){const r=Math.floor(Math.random()*4)+1,u=new Date(n.updatedDate),f=u.toLocaleDateString(`${i}`,{year:"numeric",month:"long",day:"numeric"});var e=`
                <div class="matirials__column">
                    <a class="matirials__item" href="${n.url}">
                    <div class="materials__item_content">
                        ${n.imageUrl?`<div class="matirials__item-image"><img loading="lazy" src="${n.imageUrl}" alt="Item image"></div>`:`<div class="matirials__item-image"><img loading="lazy" src="/images/matirials/Type=${r}.png" alt="Item image"></div>`}
                        <h3 class="matirials__item-title">${n.title}</h3>
                        <div class="matirials__item-tags">
                            ${n.tags.map(n=>`<span class="matirials__item-tag">${n.replace("#","")}</span>`).join("")}
                        </div>
                        ${n.text?`<p class="matirials__item-text">${n.text}</p>`:""}
                    </div>
                        <div class="materials__item_info">
                            <div><img src="/images/icons/users-round-16px.svg"/> ${n.viewsNumber} <span>${t}</span></div>
                            <div><img src="/images/icons/calendar-16px.svg"/> ${f}</div>
                        </div>
                    </a>
                </div>
            `;$(".matirials__block").append(e)}):(r=$(".matirials__block").attr("data-notFoundMessage"),$(".matirials__block").html(`<h1 style="width: 100%; text-align: center;">${r}</h1>`));updatePagination(n)}function updatePagination(n){var t,i,r;for($(".pagination__list").empty(),t=1;t<=n.totalPages;t++)i=t===n.currentPage?"active":"",r=`<li class="pagination__list-item"><a class="pagination__list-link ${i}" href="#">${t}</a></li>`,$(".pagination__list").append(r)}function getParameterByName(n){var t=new URL(window.location.href);return t.searchParams.get(n)}function handlePageChange(n){sendRequest(null,null,n);history.pushState(null,null,"?page="+n)}function initFilters(){const n=document.querySelectorAll(".matirials__category-item");n.forEach(n=>{n.addEventListener("click",()=>{n.classList.toggle("selected"),sendRequest()})})}function getCategories(){const n={};$(".matirials__category-item.selected").each(function(){const t=$(this).data("categorie"),i=$(this).data("key");n[t]||(n[t]=[]);n[t].push(i)});return Object.keys(n).map(t=>({category:t,items:n[t]}))}$(document).ready(function(){var n=getParameterByName("page");n?handlePageChange(n):handlePageChange(1);initFilters();$(".filter-form__select").on("change",function(){sendRequest()});let t,i=document.querySelector("[data-searchDelay]"),r=i.getAttribute("data-searchDelay");document.querySelector(".filter-form__input").addEventListener("input",function(){clearTimeout(t);let n=this.value;t=setTimeout(function(){sendRequest("search",n)},r)});$(".pagination__list").on("click",".pagination__list-link",function(n){n.preventDefault();var t=$(this).text();handlePageChange(t)})});